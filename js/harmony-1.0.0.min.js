// Music development for web
// @source     http://dev.music.free.fr/index.html
// @copyright  (C) 2019 Christophe Poudras
// @license    GNU General Public License version 2 or later
// This program is free software; you can redistribute it and/or modify
// it under the terms of the GNU General Public License version 2 as
// published by the Free Software Foundation.
var $HARMONY=function(){"use strict";function m(e){return i.indexOf(e[0])}function g(e){var t=p.length;for(var n=0;n<t;n++)if(e==p[n][0])return p[n][1][0];return"?"}function y(t,n,r){var i=0;if(t.length>1){var s=t.substring(1,t.length);i=e.stringToAccidental(s)}var o=r==0||r==3||r==4||r==7;return n=="d"?i-=o?1:2:n=="m"?i-=1:n=="A"&&(i+=1),t[0]+e.accidentalToString(i)}function b(t,n){var r=0,i=t==0||t==3||t==4||t==7;n=="d"?r-=i?1:2:n=="m"?r-=1:n=="A"&&(r+=1);var s=e.degreeToString(t);return e.accidentalToString(r)+s}function w(e,t){if(t===0)return"T";var n=0;for(var r=0;r<t;r++)n+=e[r];var i=(n+e[t]+e[(t+1)%7])%12,s=(i+e[(t+2)%7]+e[(t+3)%7])%12,o=(s+e[(t+4)%7]+e[(t+5)%7])%12,u=n==5||i==5||s==5,a=n==11||i==11||s==11;if(a&&u)return"D";if(a)return"d";u=u||o==5;if(u)return"SD";var f=n==8||i==8||s==8;if(f)return"SD";var l=n==6||i==6||s==6;return l?"SD":"t"}function E(e,t){var n=0;for(var r=0;r<t;r++)n+=e[r];var i=(n+e[t]+e[(t+1)%7])%12,s=(i+e[(t+2)%7]+e[(t+3)%7])%12,o=(s+e[(t+4)%7]+e[(t+5)%7])%12,u=n==5||i==5||s==5,a=n==11||i==11||s==11;if(a&&u)return"D";u=u||o==5,a=a||o==11;if(a&&u)return"D";if(u)return"SD";var f=n==8||i==8||s==8||o==8;if(!a&&f)return"SD";if(t===0)return a?"Ts":"T";var l=n==6||i==6||s==6||o==6;return l?"SD":a?"ts":"t"}function S(e,t,n){return n===undefined&&(n=!1),n?E(e,t):w(e,t)}function x(e,t){var n=[];for(var r=0;r<7;r++)n.push(S(e,r,t));return n}function T(e){return e==="G#"?"Ab":e==="D#"?"Eb":e==="A#"?"Bb":e}function N(e){return e==="Db"?"C#":e==="Gb"?"A#":e==="Cb"?"B":e}function C(t,n){var r=t,i=e.getRelativeNote(t,n[1]),s=e.getRelativeNote(t,n[2]),o=e.getRelativeNote(t,n[3]),u=e.getRelativeNote(t,n[4]),a=e.getRelativeNote(t,n[5]),f=e.getRelativeNote(t,n[6]);return[r,i,s,o,u,a,f]}function k(t,n,r){var i=t+r[0],s=e.getRelativeNote(t,n[1])+r[1],o=e.getRelativeNote(t,n[2])+r[2],u=e.getRelativeNote(t,n[3])+r[3],a=e.getRelativeNote(t,n[4])+r[4],f=e.getRelativeNote(t,n[5])+r[5],l=e.getRelativeNote(t,n[6])+r[6];return[i,s,o,u,a,f,l]}function L(e){var t=[];for(var n=0,r=e.length;n<r;n++)t.push(g(e[n]));return t}function A(t){var n=e.getHaftTones(t[1]),r=e.getHaftTones(t[2]),i=e.getHaftTones(t[3]),s=e.getHaftTones(t[4]),o=e.getHaftTones(t[5]),u=e.getHaftTones(t[6]);return[n,r-n,i-r,s-i,o-s,u-o,12-u]}function O(e,t){var n=e[t]+e[(t+1)%7],r=n+e[(t+2)%7]+e[(t+3)%7],i="dmMA",s="dPA",o=[];return o.push(i[n-2]+"3"),o.push(s[r-6]+"5"),o}function M(e,t){var n=e[t]+e[(t+1)%7],r=n+e[(t+2)%7]+e[(t+3)%7],i=r+e[(t+4)%7]+e[(t+5)%7],s="dmMA",o="dPA",u="dmM",a=[];return a.push(s[n-2]+"3"),a.push(o[r-6]+"5"),a.push(u[i-9]+"7"),a}function _(e){return A(v[e][0])}function D(e){return C(r[0],v[e][0])}function P(e,t){var n=H(e,0,t),r=H(e,1,t),i=H(e,2,t),s=H(e,3,t),o=H(e,4,t),u=H(e,5,t),a=H(e,6,t);return[n,r,i,s,o,u,a]}function H(e,t,n){return n===!0?j(e,t):B(e,t)}function B(e,t){var n=_(e);return O(n,t)}function j(e,t){var n=_(e);return M(n,t)}function F(t,n){var r=[t];for(var i=0,s=n.length;i<s;i++)r.push(e.getRelativeNote(t,n[i]));return r}function I(e){var t=[];e+=",";var n=e.indexOf(",");do t.push(e.substring(0,n)),e=e.substring(n+1,e.length),n=e.indexOf(",");while(n>0);return t}function q(t){var n=m(t);t=t.substring(1,t.length);var r=e.stringToAccidental(t),i=e.noteToString(n)+e.accidentalToString(r);return[n,r,i]}var e={};const t=!1,n=14,r=t?["Ⅰ","Ⅱ","Ⅲ","Ⅳ","Ⅴ","Ⅵ","Ⅶ"]:["I","II","III","IV","V","VI","VII"],i="CDEFGAB",s=["bbb","bb","b","","#","x","X"],o=["C","C#","Db","D","D#","Eb","E","F","F#","Gb","G","G#","Ab","A","A#","Bb","B","B#","Cb"],u=["B#","Db","C#","Cx","Eb","D#","Fb","E#","Gb","F#","Fx","Ab","G#","Gx","Bb","A#","Cb","C","B"],a=["Cb","Gb","Db","Ab","Eb","Bb","F","C","G","D","A","E","B","F#","C#"],f=["Ab","Eb","Bb","F","C","G","D","A","E","B","F#","C#","G#","D#","A#"],l=["la","si","do","ré","mi","fa","sol"],c=[["Cbb","BBBBBBB"],["Cb","bbbbbbb"],["C","       "],["C#","#######"],["Cx","xxxxxxx"],["Dbb","BBbBBBb"],["Db","bb bbb "],["D","  #   #"],["D#","##x###x"],["Dx","xxXxxxX"],["Ebb","BbbBBbb"],["Eb","b  bb  "],["E"," ##  ##"],["E#","#xx##xx"],["Ex","xXXxxXX"],["Fbb","BBB!BBB"],["Fb","bbbBbbb"],["F","   b   "],["F#","### ###"],["Fx","xxx#xxx"],["Gbb","BBBBBBb"],["Gb","bbbbbb "],["G","      #"],["G#","######x"],["Gx","xxxxxxX"],["Abb","BBbBBbb"],["Ab","bb bb  "],["A","  #  ##"],["A#","##x##xx"],["Ax","xxXxxXX"],["Bbb","BbbBbbb"],["Bb","b  b   "],["B"," ## ###"],["B#","#xx#xxx"],["Bx","xXXxXXX"]],h=[{id:"P1",halfTone:0,fr:"unison",en:"unisson"},{id:"m2",halfTone:1,fr:"seconde mineure",en:"minor second"},{id:"M2",halfTone:2,fr:"seconde majeure",en:"major second"},{id:"A2",halfTone:3,fr:"seconde augmentée",en:"augmented second"},{id:"d3",halfTone:2,fr:"tierce diminuée",en:"diminished third"},{id:"m3",halfTone:3,fr:"tierce mineure",en:"minor third"},{id:"M3",halfTone:4,fr:"tierce majeure",en:"major third"},{id:"A3",halfTone:5,fr:"tierce augmentée",en:"augmented third"},{id:"d4",halfTone:4,fr:"quarte diminuée",en:"diminished fourth"},{id:"P4",halfTone:5,fr:"quarte juste",en:"perfect fourth"},{id:"A4",halfTone:6,fr:"quarte augmentée",en:"augmented fourth"},{id:"d5",halfTone:6,fr:"quinte diminuée",en:"diminished fifth"},{id:"P5",halfTone:7,fr:"quinte juste",en:"perfect fifth"},{id:"A5",halfTone:8,fr:"quinte augmentée",en:"augmented fifth"},{id:"d6",halfTone:7,fr:"sixte diminuée",en:"diminished sixth"},{id:"m6",halfTone:8,fr:"sixte mineure",en:"minor sixth"},{id:"M6",halfTone:9,fr:"sixte majeure",en:"major sixth"},{id:"A6",halfTone:10,fr:"sixte augmentée",en:"augmented sixth"},{id:"d7",halfTone:9,fr:"septième diminuée",en:"diminished seventh"},{id:"m7",halfTone:10,fr:"septième mineure",en:"minor seventh"},{id:"M7",halfTone:11,fr:"septième majeure",en:"major seventh"},{id:"d8",halfTone:11,fr:"octave diminué",en:"diminished octave"},{id:"P8",halfTone:12,fr:"octave juste",en:"perfect octave"},{id:"A8",halfTone:13,fr:"octave augmenté",en:"augmented octave"},{id:"m9",halfTone:13,fr:"neuvième mineure",en:"minor ninth"},{id:"M9",halfTone:14,fr:"neuvième majeure",en:"major ninth"},{id:"A9",halfTone:15,fr:"neuvième augmentée",en:"augmented ninth"},{id:"P11",halfTone:17,fr:"onzième juste",en:"perfect eleven"},{id:"A11",halfTone:18,fr:"onzième augmentée",en:"augmented eleven"},{id:"m13",halfTone:20,fr:"treizième mineure",en:"minor thirteen"},{id:"M13",halfTone:21,fr:"treizième majeure",en:"major thirteen"},{id:"TT",halfTone:6,fr:"triton",en:"tritone"}],p=[["M2,M3,P5",["add2","add9","(9)"],{fr:"add 9",en:"add 9"}],["M2,P5",["sus2"],{fr:"suspendu 2",en:"suspended 2"}],["M2,P5,M6",["6sus2"]],["M2,P5,m7",["7sus2"]],["d3,d5,d7",["!d3d5d7"]],["m3,d5",["°","mb5","m(b5)","dim"],{fr:"diminué",en:"diminished"}],["m3,d5,d7",["°7","dim7"],{fr:"diminué 7",en:"diminished 7"},"de septième diminuée"],["m3,d5,d7,m9",["°7b9","dim7b9"]],["m3,d5,d7,M9",["°79","dim79"]],["m3,d5,d7,A9",["°7#9","dim7#9"]],["m3,d5,m7",["Ø7","m7b5","m(b5)7"],{fr:"demi-diminué",en:"half-diminished"},"mineur 7, quinte diminuée"],["m3,d5,m7,m9",["Ø7b9","m7b5b9","m(b5)7b9"]],["m3,d5,m7,M9",["Ø79","m7b59","m(b5)79","Ø7,9"]],["m3,d5,m7,A9",["Ø7#9","m7b5#9","m(b5)7#9"]],["m3,P5",["m"],{fr:"mineur",en:"minor"}],["m3,P5,M6",["m6"],{fr:"mineur six",en:"minor 6"}],["m3,P5,M6,m9",["m6b9"]],["m3,P5,M6,M9",["m69"]],["m3,P5,M6,A9",["m6#9"]],["m3,A5,M6",["m6+"]],["m3,P5,m7",["m7"],{fr:"mineur 7",en:"minor 7"}],["m3,P5,m7,m9",["m7b9","m7,b9"]],["m3,P5,m7,M9",["m79","m9","m7,9"]],["m3,P5,m7,A9",["m7#9","m7,#9"]],["m3,P5,M7",["mM7"],{fr:"mineur, majeure 7",en:"minor, 7 major"}],["m3,P5,M7,m9",["mM7b9","mM7,b9"]],["m3,P5,M7,M9",["mM79","mM7,9"]],["m3,P5,M7,A9",["mM7#9","mM7,#9"]],["M3,d5",["(b5)","-5"]],["M3,d5,m7",["7b5"],{fr:"7, quinte diminuée",en:"7 diminished fifth"}],["M3,d5,m7,m9",["7b5b9"]],["M3,d5,m7,M9",["7b59"]],["M3,d5,m7,A9",["7b5#9"]],["M3,d5,M7",["M7b5","Δ7b5"]],["M3,d5,M7,m9",["M7b5b9","Δ7b5b9"]],["M3,d5,M7,M9",["M7b59","Δ7b59"]],["M3,d5,M7,A9",["M7b5#9","Δ7b5#9"]],["M3,P5",["","M","Maj"],{fr:"majeur",en:"major"}],["M3,P5,M6",["6"],{fr:"majeur six",en:"major 6"}],["M3,P5,M6,m9",["6b9"]],["M3,P5,M6,M9",["69","6add9","6/9"]],["M3,P5,M6,A9",["6#9"]],["M3,P5,m7",["7"],{fr:"7",en:"7"},{fr:"de septième de dominante",en:"dominant seventh"}],["M3,P5,m7,m9",["7b9","7,b9"],{fr:"7 bémol 9",en:"7 flat 9"}],["M3,P5,m7,M9",["79","9","7,9"],{fr:"7 majeure 9",en:"7 major 9"}],["M3,P5,m7,A9",["7#9","7,#9"],{fr:"7 dièse 9",en:"7 sharp 9"}],["M3,P5,M7",["M7","Δ7"],{fr:"majeure 7",en:"major 7"}],["M3,P5,M7,m9",["M7b9","Δ7b9","M7,b9"]],["M3,P5,M7,M9",["M79","Δ79","M9","M7,9"]],["M3,P5,M7,A9",["M7#9","Δ7#9","M7,#9"]],["M3,A5",["+5","(#5)","+"],{fr:"augmenté",en:"augmented"}],["M3,A5,M6",["6+"]],["M3,A5,m7",["7#5","7+","+7"],{fr:"7 à quinte augmentée",en:"7 with augmented fifth"},"de septième de dominante à quinte augmentée"],["M3,A5,m7,m9",["7#5b9","7+b9","+7b9"]],["M3,A5,m7,M9",["7#59","7+9","+79"]],["M3,A5,m7,A9",["7#5#9","7+#9","+7#9"]],["M3,A5,M7",["+M7","M7#5","M7+","+Δ7","M7,#5"],{fr:"majeure 7, quinte augmentée",en:"major 7 with augmented fifth"}],["M3,A5,M7,m9",["+M7b9","M7#5b9","M7+b9","+Δ7b9"]],["M3,A5,M7,M9",["+M79","M7#59","M7+9","+Δ79"]],["M3,A5,M7,A9",["+M7#9","M7#5#9","M7+#9","+Δ7#9"]],["P4,P5",["sus","sus4"],{fr:"suspendu 4",en:"suspended 4"}],["P4,P5,M9",["sus49","sus4add9","add9sus4"]],["P4,P5,M6",["6sus4"]],["P4,P5,m7",["7sus","7sus4"],{fr:"7 suspendu 4",en:"7 suspended 4"}],["P4,P5,m7,m9",["7b9sus4","7sus4b9"]],["P4,P5,m7,M9",["79sus4","7sus49"]],["P4,P5,m7,A9",["7#9sus4","7sus4#9"]],["M3,P5,M7,M13",["M7,13"]],["M3,P5,M7,M9,M13",["M7,9,13"]],["M3,P5,M7,M9,A11",["M7,9,#11"]],["m3,P5,m7,P11",["m7,11","m11"]],["m3,P5,m7,M9,M13",["m7,9,13"]],["M3,P5,m7,m9,A11",["7,b9,#11"]],["M3,P5,m7,m9,m13",["7,b9,b13"]],["M3,P5,m7,m9,M13",["7,b9,13","13b9"]],["M3,P5,m7,M9,A11",["7,9,#11","9#11"]],["M3,P5,m7,M9,m13",["7,9,b13"]],["M3,P5,m7,M9,M13",["7,9,13","13"]],["M3,P5,m7,A9,m13",["7,#9,b13","7 alt"]],["M3,P5,m7,A9,M13",["7,#9,13","13#9"]],["m3,d5,m7,P11",["Ø7,11"]],["m3,d5,m7,m13",["Ø7,b13"]]],d=[["MAJ1","ionien"],["MAJ2","dorien"],["MAJ3","phrygien"],["MAJ4","lydien"],["MAJ5","mixolydien"],["MAJ6","éolien"],["MAJ7","locrien"],["MEL1","mode I"],["MEL2","mode II"],["MEL3","mode III"],["MEL4","mode IV"],["MEL5","mode V"],["MEL6","mode VI"],["MEL7","mode VII"],["HAR1","mode I"],["HAR2","mode II"],["HAR3","mode III"],["HAR4","mode IV"],["HAR5","mode V"],["HAR6","mode VI"],["HAR7","mode VII"],["NAT1","éolien"],["NAT2","locrien"],["NAT3","ionien"],["NAT4","dorien"],["NAT5","phrygien"],["NAT6","lydien"],["NAT7","mixolydien"]],v=[[["P1","M2","M3","P4","P5","M6","M7"],["majeur","majeur"],!0,"majeur diatonique","ionien, mode de do"],[["P1","M2","m3","P4","P5","M6","m7"],["mineur","mineur"],!0,"dorien","de ré"],[["P1","m2","m3","P4","P5","m6","m7"],["phrygien","phrygien"],!0,"phrygien","de mi"],[["P1","M2","M3","A4","P5","M6","M7"],["lydien","majeur"],!0,"lydien","de fa"],[["P1","M2","M3","P4","P5","M6","m7"],["majeur","mineur"],!0,"mixolydien","de sol"],[["P1","M2","m3","P4","P5","m6","m7"],["mineur","phrygien"],!0,"éolien","mineur naturel, mode de la"],[["P1","m2","m3","P4","d5","m6","m7"],["locrien","lydien"],!0,"locrien","de si"],[["P1","M2","m3","P4","P5","M6","M7"],["mineur","majeur"],!0,"mineur mélodique"],[["P1","m2","m3","P4","P5","M6","m7"],["phrygien","mineur"],!0,"javanais","dorien b2, mode II de la gamme mineure mélodique"],[["P1","M2","M3","A4","A5","M6","M7"],["augmenté","diminué"],!0,"lydien augmenté","III de la gamme mineure mélodique"],[["P1","M2","M3","A4","P5","M6","m7"],["lydien","mineur"],!0,"de Bartók","lydien dominant, mode acoustique, mode IV de la gamme mineure mélodique"],[["P1","M2","M3","P4","P5","m6","m7"],["majeur","phrygien"],!0,"hindou","mixolydien b13, mode V de la gamme mineure mélodique"],[["P1","M2","m3","P4","d5","m6","m7"],["Y","lydien"],!0,"mineur diminué","éolien b5, mode VI de la gamme mineure mélodique"],[["P1","m2","m3","d4","d5","m6","m7"],["locrien-mineur","lydien"],!0,"superlocrien","VII de la gamme mineure mélodique"],[["P1","M2","m3","P4","P5","m6","M7"],["mineur","harmonique"],!0,"mineur harmonique"],[["P1","m2","m3","P4","d5","M6","m7"],["locrien","?"],!0,"locrien 6","II de la gamme mineure harmonique"],[["P1","M2","M3","P4","A5","M6","M7"],["?","diminué"],!0,"ionien #5","III de la gamme mineure harmonique"],[["P1","M2","m3","A4","P5","M6","m7"],["mineur-lydien","mineur"],!0,"roumain","dorien #4, mode IV de la gamme mineure harmonique"],[["P1","m2","M3","P4","P5","m6","m7"],["harmonique","phrygien"],!0,"andalous","superphrygien, mode V de la gamme mineure harmonique"],[["P1","A2","M3","A4","P5","M6","M7"],["hongrois","majeur"],!0,"lydien #2","VI de la gamme mineure harmonique"],[["P1","m2","m3","d4","d5","m6","d7"],["locrien-mineur","?"],!0,"diminué","VII de la gamme mineure harmonique"],[["P1","M2","m3","P4","P5","m6","m7"],["mineur","phrygien"],!0,"mineur naturel","éolien, mode de la"],[["P1","m2","m3","P4","d5","m6","m7"],["locrien","lydien"],!0,"locrien","de si"],[["P1","M2","M3","P4","P5","M6","M7"],["majeur","majeur"],!0,"majeur diatonique","ionien, mode de do"],[["P1","M2","m3","P4","P5","M6","m7"],["mineur","mineur"],!0,"dorien","de ré"],[["P1","m2","m3","P4","P5","m6","m7"],["phrygien","phrygien"],!0,"phrygien","de mi"],[["P1","M2","M3","A4","P5","M6","M7"],["lydien","majeur"],!0,"lydien","de fa"],[["P1","M2","M3","P4","P5","M6","m7"],["majeur","mineur"],!0,"mixolydien","de sol"],[["P1","M2","M3","P4","P5","m6","M7"],["majeur","harmonique"],!0,"éthiopien"],[["P1","m2","m3","P4","P5","M6","M7"],["phrygien","majeur "],!1,"napolitain"],[["P1","m2","m3","P4","P5","m6","M7"],["phrygien","harmonique"],!1,"napolitain harmonique"],[["P1","M2","m3","A4","P5","m6","m7"],["mineur-lydien","phrygien"],!1,"gitan","gitan hongrois"],[["P1","M2","m3","A4","P5","m6","M7"],["mineur-lydien","harmonique"],!1,"tzigane","hongrois mineur"],[["P1","A2","M3","A4","P5","M6","m7"],["hongrois","mineur"],!1,"hongrois majeur"],[["P1","m2","M3","P4","P5","m6","M7"],["harmonique","harmonique"],!1,"bohémien","byzantin"],[["P1","m2","M3","P4","P5","M6","m7"],["harmonique","mineur"],!0,"gypzy"],[["P1","m2","M3","A4","A5","A6","M7"],["?","?"],!1,"enigmatic"],[["P1","A2","M3","A4","P5","A6","M7"],["hongrois","?"],!1,"Sebastian"],[["P1","m2","m3","d4","P5","m6","m7"],["?","phrygien"],!0,"indien"],[["P1","M2","M3","P4","d5","m6","m7"],["?","lydien"],!1,"arabe"],[["P1","m2","M3","P4","d5","M6","m7"],["?","?"],!1,"oriental"],[["P1","m2","M3","P4","d5","m6","m7"],["?","lydien"],!1,"locrien majeur"],[["P1","m2","M3","P4","d5","m6","M7"],["?","?"],!1,"persan"],[["P1","m2","M3","P4","A5","M6","m7"],["?","?"],!1,"mixolydien augmenté"],[["P1","M2","M3","A4","P5","m6","m7"],["lydien","phrygien"],!1,"lydien mineur"]];return e.getTones=function(){return o},e.noteToString=function(e){return i[e%7]},e.accidentalToString=function(e){return s[e+3]},e.degreeToString=function(e){return r[e%7]},e.getTonalities=function(e){return e?f:a},e.getModeIntervals=function(e){return v[e][0]},e.getModeStructure=function(e){return v[e][1]},e.isModeHarmonizable=function(e){return v[e][2]},e.getModeName=function(e){return v[e][3]},e.getModeName2=function(e){return v[e][4]},e.getModeID=function(e){return d[e][0]},e.getModeNaturalName=function(e){return d[e][1]},e.stringToAccidental=function(e){var t=0;return e[0]=="b"?(t=-1,e[1]=="b"&&t--):e[0]=="#"?t=1:e[0]=="x"?t=2:e[0]=="X"?t=3:e[0]=="B"&&(t=-2),t},e.getHaftTones=function(e){for(var t=0,n=h.length;t<n;t++)if(e==h[t].id)return h[t].halfTone;return 0},e.getIntervalName=function(e,t){for(var n=0,r=h.length;n<r;n++)if(e==h[n].id)return t!==undefined?h[n].fr:h[n].en;return"!?!"},e.getModeNotes=function(e,t){return t=="I"||t=="Ⅰ"?D(e):C(t,v[e][0])},e.getModeSignatures=function(e,t){var n=P(e,t);return L(n)},e.getModeSignature=function(e,t,n){var r=H(e,t,n);return g(r)},e.getModeChords=function(t,n,r){if(n=="I")return e.getModeSignatures(t,r);var i=e.getModeSignatures(t,r),s=v[t][0];return k(n,s,i)},e.getModeFunctions=function(e,t){var n=_(e);return x(n,t)},e.getChordIntervals=function(e){for(var t=0,n=p.length;t<n;t++)for(var r=0,i=p[t][1].length;r<i;r++)if(e==p[t][1][r])return I(p[t][0]);return"?"},e.getChordSignatureName=function(e,t){for(var n=0,r=p.length;n<r;n++)for(var i=0,s=p[n][1].length;i<s;i++)if(e==p[n][1][i])return t!==undefined?p[n][2].fr:p[n][2].en;return undefined},e.getChordNumberOfNote=function(t){var n=e.getChordIntervals(t);return n.length+1},e.getChordNotes=function(t){var n=e.getChordFondamental(t),r=e.getChordSignature(t),i=e.getChordIntervals(r),s=F(n,i),o=t.indexOf("/");if(o!=-1){var u=e.getChordBass(t),a=!1,f=s.slice();for(var l=0,c=s.length;l<c;l++){if(u===s[l]){a=!0,s=f;break}var h=f[0];f.shift(),f.push(h)}a||s.unshift(u)}return s},e.getChordFondamental=function(t){var n=q(t);return e.noteToString(n[0])+e.accidentalToString(n[1])},e.getChordBass=function(t){var n=t.indexOf("/");return n!=-1?t.substring(n+1,t.length):e.getChordFondamental(t)},e.getChordSignature=function(t){var n=e.getChordFondamental(t),r=t.indexOf("/");return r!=-1?t.substring(n.length,r):t.substring(n.length,t.length)},e.getToneOfTonality=function(e){return e.substring(1,e.length)},e.getToneAndMode=function(e){var t=e.substring(1,e.length),r=e[0]=="m",i=r?n:0;return{tone:t,mode:i,minor:r}},e.getToneAndMinor=function(e){var t=e.substring(1,e.length),n=e[0]=="m";return{tone:t,minor:n}},e.getEnharmonicTone=function(e){var t=e.substring(1,e.length);return e[0]==="m"?{minor:t,major:T(t)}:{major:t,minor:N(t)}},e.getEnharmonic=function(e){for(var t=0,n=o.length;t<n;t++)if(o[t]===e)return u[t];return e},e.getFarthestTone=function(t){var n=e.getRelativeNote(t,"d5"),r=e.stringToAccidental(n.substring(1,n.length));return r==-2&&(n=e.getRelativeNote(t,"A4")),n},e.getSimpleTone=function(t){var n=e.stringToAccidental(t.substring(1,t.length));return n===-2?t=e.getRelativeNote(t[0],"m7"):n===-1?t==="Fb"?t="E":t==="Cb"&&(t="B"):n===1?t==="E#"?t="F":t==="B#"&&(t="C"):n===2&&(t=e.getRelativeNote(t[0],"M2")),t},e.getRelativeNote=function(t,n){if(n=="P1"||n=="P8")return t=="I"?r[0]:t;for(var i=0,s=c.length;i<s;i++)if(t==c[i][0]){var o=0;n.length===3?o=(parseFloat(n[1]+n[2])-1)%7:o=(parseFloat(n[1])-1)%7;var u=m(t)+o,a=e.noteToString(u)+c[i][1][o],f=n[0];return y(a,f,o)}return b((parseFloat(n[1])-1)%7,n[0])},e.getRelativeNotes=function(t,n){var r=[];for(var i=0,s=n.length;i<s;i++)r.push(e.getRelativeNote(t,n[i]));return r},e.getNotesFromSignature=function(t,n){var r=e.getChordIntervals(n),i=e.getRelativeNotes(t,r);return i.unshift(t),i},e.getHarmonicFunction=function(e,t,n){var r=A(e);return S(r,t,n)},e.getKeyNotes=function(t){var n=0,r=t,i=t.indexOf("m");return i!==-1&&(n=21,r=t.substring(0,i)),e.getModeNotes(n,r)},e.getLatinNote=function(e){return l[e[0].charCodeAt(0)-"A".charCodeAt(0)]+e.substring(1,e.length)},e.getChordName=function(t,n,r,i){var s=e.getChordSignatureName(n,r);if(s===undefined)return"";var o=t;return r!==undefined?(i===undefined&&(i=!0),o=e.getLatinNote(t),o=i?"<i>"+o+"</i>":o,o.indexOf("bb")!=-1?o=o.replace("bb"," double bémol"):o.indexOf("b")!=-1?o=o.replace("b"," bémol"):o.indexOf("#")!=-1?o=o.replace("#"," dièse"):o.indexOf("x")!=-1&&(o=o.replace("x"," double dièse"))):o.indexOf("bb")!=-1?o=o.replace("bb"," double flat"):o.indexOf("b")!=-1?o=o.replace("b"," flat"):o.indexOf("#")!=-1?o=o.replace("#"," sharp"):o.indexOf("x")!=-1&&(o=o.replace("x"," double sharp")),o+" "+s},e.getChordHtmlFormat=function(e){var t=e.replace(/\//g,'<span class="normal">/</span>');t=t.replace(/,/g,'<span class="exp">,</span>'),e.indexOf("sub")!==-1&&(t=t.replace("sub",'<span class="sub">sub</span>'));if(e==="dim7")return t;e!=="dim"&&e.indexOf("dim")!==-1&&(t=t.replace("dim",'<span class="exp">dim</span>'));if(e.indexOf("sus4add9")!==-1)return t=t.replace("sus4add9",'<ul class="ul-sus-add"><li class="li-sus-add">add9</li><li class="li-sus-add">sus4</li></ul>'),t;if(e.indexOf("5")!==-1&&e.indexOf("|")===-1)if(e.indexOf("(#5)")!==-1)t=t.replace("(#5)",'<span class="exp">#5</span>');else if(e.indexOf("#5")!==-1)t=t.replace("#5",'<span class="exp">#5</span>');else if(e.indexOf("+5")!==-1){if(e==="+5")return t;t=t.replace("+5",'<span class="exp">+5</span>')}else t=t.replace("b5",'<span class="exp">b5</span>');e.indexOf("6")!==-1&&e.indexOf("|")===-1&&(t=t.replace("6",'<span class="exp">6</span>'));if(e.indexOf("7")!==-1&&e.indexOf("|")===-1){if(e.indexOf("M7")!==-1){if(e==="M7")return t;if(e.indexOf("+M7")!==-1){if(e==="+M7")return t;t=t.replace("+M7",'<span class="exp">+M7</span>')}else t=t.replace("M7",'<span class="exp">M7</span>')}else if(e.indexOf("°7")!==-1){if(e==="°7")return t;t=t.replace("°7",'<span class="exp">°7</span>')}else if(e.indexOf("Ø7")!==-1){if(e==="Ø7")return t;t=t.replace("Ø7",'<span class="exp">Ø7</span>')}else if(e.indexOf("7/")!==-1&&e.indexOf("/7")!==-1)t=t.replace("7",'<span class="exp">7</span>');else if(e.indexOf("/7")===-1&&e==="7")return t;t=t.replace("7",'<span class="exp">7</span>')}return e.indexOf("9")!==-1&&e.indexOf("/9")===-1&&(e.indexOf("M9")!==-1?t=t.replace("M9",'<span class="exp">M9</span>'):e.indexOf("b9")!==-1?t=t.replace("b9",'<span class="exp">b9</span>'):e.indexOf("#9")!==-1?t=t.replace("#9",'<span class="exp">#9</span>'):e.indexOf("add9")!==-1?t=t.replace("add9",'<span class="add">add9</span>'):t=t.replace("9",'<span class="exp">9</span>')),e.indexOf("11")!==-1&&(e.indexOf("#11")!==-1?t=t.replace("#11",'<span class="exp">#11</span>'):t=t.replace("11",'<span class="exp">11</span>')),e.indexOf("13")!==-1&&(e.indexOf("b13")!==-1?t=t.replace("b13",'<span class="exp">b13</span>'):t=t.replace("13",'<span class="exp">13</span>')),t=t.replace("sus2",'<span class="sus">sus2</span>'),t=t.replace("sus4",'<span class="sus">sus4</span>'),e.indexOf("|64")!==-1?t=t.replace("|64",'<span class="inversion-sup">6</span><span class="inversion-sub">4</span>'):e.indexOf("|65")!==-1?t=t.replace("|65",'<span class="inversion-sup">6</span><span class="inversion-sub">5</span>'):e.indexOf("|43")!==-1?t=t.replace("|43",'<span class="inversion-sup">4</span><span class="inversion-sub">3</span>'):e.indexOf("|42")!==-1?t=t.replace("|42",'<span class="inversion-sup">4</span><span class="inversion-sub">2</span>'):e.indexOf("|6")!==-1?t=t.replace("|6",'<span class="inversion-sup">6</span>'):e.indexOf("|7")!==-1&&(t=t.replace("|7",'<span class="inversion-sup">7</span>')),t},e}()